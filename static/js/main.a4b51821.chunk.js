(this["webpackJsonpreact-ws-chat"]=this["webpackJsonpreact-ws-chat"]||[]).push([[0],{112:function(e,n,t){},113:function(e,n,t){"use strict";t.r(n);var a,s=t(0),c=t.n(s),i=t(31),o=t.n(i),r=(t(99),function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,171)).then((function(n){var t=n.getCLS,a=n.getFID,s=n.getFCP,c=n.getLCP,i=n.getTTFB;t(e),a(e),s(e),c(e),i(e)}))}),l=t(37),u=t.n(l),d=t(54),j=t(13),m=t(164),f=t(166),b=t(14),O=t(49);a=s.createContext(undefined);var g,h={me:{name:""},messages:[],messageValue:"",nameValue:"",isLoading:!1,isConnected:!1},p=function(e,n){switch(n.type){case"set_me":case"set_loading":case"set_message_value":case"set_name_value":case"set_connected":return Object(O.a)(Object(O.a)({},e),n.payload);case"set_messages":return Object(O.a)(Object(O.a)({},e),{},{messages:[].concat(Object(b.a)(e.messages),[n.payload.messages])});default:throw new Error}},v=function(e){return{type:"set_connected",payload:{isConnected:e}}},x=function(e){return{type:"set_loading",payload:{isLoading:e}}},y=function(e){return{type:"set_message_value",payload:{messageValue:e}}},C=function(e){return{type:"set_messages",payload:{messages:e}}};!function(e){e.MESSAGE="message",e.QUIT="quit",e.CONNECTION="connection"}(g||(g={}));var w=t(160),N=Object(w.a)({root:{justifyContent:"center"},title:{display:"grid",gridTemplateRows:"1fr 1fr"}}),_=t(2),S=function(){var e=Object(s.useContext)(a),n=Object(j.a)(e,3),t=(n[0],n[1],n[2],N());return Object(_.jsx)(m.a,{color:"transparent",variant:"outlined",position:"static",children:Object(_.jsx)(f.a,{className:t.root,children:Object(_.jsx)("div",{className:t.title,children:Object(_.jsx)("strong",{children:"\u0414\u043e\u0431\u0440\u043e \u043f\u043e\u0436\u0430\u043b\u043e\u0432\u0430\u0442\u044c \u0438\u043c\u0435\u043d\u0438 \u0428\u0430\u043b\u0442\u0430\u0439 \u0411\u043e\u043b\u0442\u0430\u044f"})})})})},T=t(16),k=t(5),E=t(167),I=t(163),R=t(159),V=t(161),M=t(168),F=function(e){return Object(_.jsx)(E.a,{children:Object(_.jsx)(I.a,{container:!0,alignItems:"center",justifyContent:"center",style:{height:window.innerHeight-30},children:Object(_.jsx)(M.a,{color:"primary"})})})},J=Object(w.a)({messagesRoot:{maxHeight:window.innerHeight-30},messages:{width:"100%",height:"70vh",backgroundColor:"#354765",overflowY:"auto"},newMessageRoot:{position:"relative",width:"80%",rowGap:20,color:"#ffffff"},emojiRoot:{position:"absolute",zIndex:1,top:10},sendButton:{backgroundColor:"#354765",color:"#ffffff"},picker:{top:-350}}),L=Object(w.a)({info:{color:"#afbed2",margin:"20px 30px"}}),B=function(e){var n=e.isMe,t=e.message,a=e.ref,s=L(),c={minWidth:"20vw",margin:10,backgroundColor:n?"#3a64a8":"#224e94",color:"#ffffff",borderRadius:"4%",marginLeft:n?"auto":"10%",marginRight:n?"10%":0,maxWidth:"40%",width:"fit-content",padding:15,display:"grid",rowGap:20,fontFamily:"serif","&:firstChild":{fontFamily:"sans-serif"}};return Object(_.jsxs)(I.a,{direction:"column",container:!0,children:[t.event===g.MESSAGE?Object(_.jsxs)("div",{style:c,children:[Object(_.jsx)("h3",{children:t.name}),Object(_.jsx)("span",{children:t.body})]}):t.event===g.CONNECTION?Object(_.jsxs)("span",{className:s.info,children:[t.name," \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u043b\u0441\u044f \u043a \u0447\u0430\u0442\u0443.. ."]}):Object(_.jsxs)("span",{className:s.info,children:[t.name," \u0432\u044b\u0448\u0435\u043b \u0438\u0437 \u0447\u0430\u0442\u0430.. ."]}),Object(_.jsx)("div",{ref:a})]},t.id)},D=t(66),H=t.n(D),A=t(83),G=t.n(A),W=t(82),P=t.n(W),U=(t(169),"/CHAT_ROUTE"),K=[{path:U,Component:function(e){var n=Object(s.useContext)(a),t=Object(j.a)(n,3),c=t[0],i=t[1],o=t[2],r=Object(s.useRef)(null),l=J(),u=Object(s.useState)(null),d=Object(j.a)(u,2),m=d[0],f=d[1],b=Object(s.useState)(!1),O=Object(j.a)(b,2),g=O[0],h=O[1];Object(s.useEffect)((function(){!function(){var e;null===(e=r.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})}()}),[c]);return c.isLoading?Object(_.jsx)(F,{}):Object(_.jsx)(E.a,{children:Object(_.jsxs)(I.a,{container:!0,className:l.messagesRoot,alignItems:"center",children:[m&&Object(_.jsx)("span",{children:m.emoji}),Object(_.jsx)("div",{className:l.messages,children:c.messages.length&&c.messages.map((function(e){var n=c.nameValue===e.name;return Object(_.jsx)(B,{ref:r,isMe:n,message:e})}))}),Object(_.jsxs)(I.a,{className:l.newMessageRoot,container:!0,direction:"column",alignItems:"flex-end",children:[Object(_.jsx)(R.a,{variant:"filled",onChange:function(e){return i(y(e.currentTarget.value))},value:c.messageValue,fullWidth:!0}),Object(_.jsx)("div",{className:P()(l.emojiRoot,Object(k.a)({},l.picker,g)),onBlur:function(){return h(!1)},children:g?Object(_.jsx)(H.a,{onEmojiClick:function(e,n){f(n)},skinTone:D.SKIN_TONE_MEDIUM_DARK}):Object(_.jsx)(V.a,{onClick:function(){return h(!0)},children:Object(_.jsx)(G.a,{})})}),Object(_.jsx)(V.a,{className:l.sendButton,onClick:function(){var e,n={event:"message",id:Date.now().toString(),name:c.me.name,body:c.messageValue};null===o||void 0===o||o.send(JSON.stringify(n)),i(y("")),null===(e=r.current)||void 0===e||e.scrollTo(0,r.current.scrollHeight)},variant:"outlined",children:"send"})]})]})})}}],q=function(){return Object(_.jsxs)(T.d,{children:[K.map((function(e){var n=e.path,t=e.Component;return Object(_.jsx)(T.b,{path:n,component:t,exact:!0},n)})),Object(_.jsx)(T.a,{to:U})]})},z=(t(112),t(64)),Q=function(){var e,n=Object(s.useReducer)(p,h),t=Object(j.a)(n,2),c=t[0],i=t[1],o=Object(s.useState)(null),r=Object(j.a)(o,2),l=r[0],m=r[1],f=s.useMemo((function(){return[c,i,l]}),[c,l]),b=function(){var e=Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i({type:"set_me",payload:{me:{id:Date.now().toString(),name:c.nameValue}}}),i(x(!0)),e.t0=m,e.next=5,new WebSocket("wss://ws-simple-chat-api.herokuapp.com");case 5:e.t1=e.sent,(0,e.t0)(e.t1);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();if(l&&(l.onmessage=function(e){i(C(JSON.parse(e.data)))},l.onopen=function(){i(v(!0));var e={event:g.CONNECTION,id:c.me.id,name:c.nameValue,body:""};null===l||void 0===l||l.send(JSON.stringify(e)),i(x(!1))},l.onmessage=function(e){var n=JSON.parse(e.data);i(C(n))},l.onclose=function(){i(v(!1));var e={event:g.CONNECTION,id:c.me.id,name:c.nameValue,body:""};l.send(JSON.stringify(e))},l.onerror=function(){i(v(!1)),setTimeout((function(){return b()}),1e3)}),c.isLoading)return Object(_.jsx)(F,{});var O=(null===(e=c.nameValue)||void 0===e?void 0:e.trim().length)<3;return Object(_.jsx)(z.a,{children:Object(_.jsxs)(a.Provider,{value:f,children:[Object(_.jsx)(S,{}),c.isConnected?Object(_.jsx)(q,{}):Object(_.jsx)(_.Fragment,{children:Object(_.jsxs)(I.a,{container:!0,justifyContent:"center",alignItems:"stretch",children:[Object(_.jsx)(R.a,{variant:"filled",onChange:function(e){return i(function(e){return{type:"set_name_value",payload:{nameValue:e}}}(e.currentTarget.value))},value:c.nameValue}),Object(_.jsx)(V.a,{disabled:O,color:"info",onClick:b,variant:"contained",children:"connect"})]})})]})})};o.a.render(Object(_.jsx)(c.a.StrictMode,{children:Object(_.jsx)(Q,{})}),document.getElementById("root")),r()},99:function(e,n,t){}},[[113,1,2]]]);
//# sourceMappingURL=main.a4b51821.chunk.js.map