(this["webpackJsonpreact-ws-chat"]=this["webpackJsonpreact-ws-chat"]||[]).push([[0],{103:function(e,t,n){},116:function(e,t,n){},117:function(e,t,n){"use strict";n.r(t);var s,a=n(0),i=n.n(a),c=n(26),o=n.n(c),r=(n(103),function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,175)).then((function(t){var n=t.getCLS,s=t.getFID,a=t.getFCP,i=t.getLCP,c=t.getTTFB;n(e),s(e),a(e),i(e),c(e)}))}),u=n(40),l=n.n(u),j=n(55),d=n(13),f=n(168),m=n(170),b=n(164),O=Object(b.a)({root:{justifyContent:"center"},title:{display:"grid",gridTemplateRows:"1fr 1fr"}});s=a.createContext(undefined);var h,g=n(2),v=function(){var e=Object(a.useContext)(s),t=Object(d.a)(e,2),n=(t[0],t[1],O());return Object(g.jsx)(f.a,{color:"transparent",variant:"outlined",position:"static",children:Object(g.jsx)(m.a,{className:n.root,children:Object(g.jsx)("div",{className:n.title,children:Object(g.jsx)("strong",{children:"\u0414\u043e\u0431\u0440\u043e \u043f\u043e\u0436\u0430\u043b\u043e\u0432\u0430\u0442\u044c \u0438\u043c\u0435\u043d\u0438 \u0428\u0430\u043b\u0442\u0430\u0439 \u0411\u043e\u043b\u0442\u0430\u044f"})})})})},x=n(16),p=n(85),C=n(171),N=n(167),w=n(163),y=n(165),k=n(172),M=function(e){return Object(g.jsx)(C.a,{children:Object(g.jsx)(N.a,{container:!0,alignItems:"center",justifyContent:"center",style:{height:window.innerHeight-30},children:Object(g.jsx)(k.a,{color:"primary"})})})},V=Object(b.a)({messagesRoot:{maxHeight:window.innerHeight-30},messages:{width:"100%",height:"70vh",backgroundColor:"#354765",overflowY:"auto"},newMessageRoot:{position:"relative",width:"80%",rowGap:20,color:"#ffffff"},emojiRoot:{position:"absolute",zIndex:1,top:10},sendButton:{backgroundColor:"#354765",color:"#ffffff"},picker:{top:-350}}),S=Object(b.a)({info:{color:"#afbed2",margin:"20px 30px"}}),E=n(58),T=n(59),I=n(18);!function(e){e.MESSAGE="message",e.QUIT="quit",e.CONNECTION="connection"}(h||(h={}));var R=function(){function e(){Object(E.a)(this,e),this.me={name:""},this.messages=[],this.messageValue="",this.nameValue="",this.isLoading=!1,this.isConnected=!1,Object(I.d)(this)}return Object(T.a)(e,[{key:"setMe",value:function(e){this.me=e}},{key:"setConnected",value:function(e){this.isConnected=e}},{key:"setLoading",value:function(e){this.isLoading=e}},{key:"setMessageValue",value:function(e){this.messageValue=e}},{key:"setNameValue",value:function(e){this.nameValue=e}},{key:"setMessages",value:function(e){this.messages.push(e)}}]),e}(),L=n(33),F=Object(L.a)((function(e){var t=e.isMe,n=e.message,s=e.ref,a=S(),i={minWidth:"20vw",margin:10,backgroundColor:t?"#3a64a8":"#224e94",color:"#ffffff",borderRadius:"4%",marginLeft:t?"auto":"10%",marginRight:t?"10%":0,maxWidth:"40%",width:"fit-content",padding:15,display:"grid",rowGap:20,fontFamily:"serif","&:firstChild":{fontFamily:"sans-serif"}};return Object(g.jsxs)(N.a,{direction:"column",container:!0,children:[n.event===h.MESSAGE?Object(g.jsxs)("div",{style:i,children:[Object(g.jsx)("h3",{children:n.name}),Object(g.jsx)("span",{children:n.body})]}):n.event===h.CONNECTION?Object(g.jsxs)("span",{className:a.info,children:[n.name," \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u043b\u0441\u044f \u043a \u0447\u0430\u0442\u0443.. ."]}):Object(g.jsxs)("span",{className:a.info,children:[n.name," \u0432\u044b\u0448\u0435\u043b \u0438\u0437 \u0447\u0430\u0442\u0430.. ."]}),Object(g.jsx)("div",{ref:s})]},n.id)})),J=n(5),A=n(86),B=n.n(A),D=n(70),H=n.n(D),P=n(87),_=n.n(P),G=Object(L.a)((function(e){e.children;var t=Object(a.useContext)(s),n=Object(d.a)(t,2),i=n[0],c=(n[1],V()),o=Object(a.useState)(!1),r=Object(d.a)(o,2),u=r[0],l=r[1];return Object(g.jsx)("div",{className:B()(c.emojiRoot,Object(J.a)({},c.picker,u)),onBlur:function(){return l(!1)},children:u?Object(g.jsx)(H.a,{native:!0,groupNames:{smileys_people:"PEOPLE"},disableAutoFocus:!0,onEmojiClick:function(e,t){i.setMessageValue(t.emoji)},skinTone:D.SKIN_TONE_MEDIUM_DARK}):Object(g.jsx)(y.a,{onClick:function(){return l(!0)},children:Object(g.jsx)(_.a,{})})})})),W=Object(L.a)((function(e){Object(p.a)(e);var t=Object(a.useContext)(s),n=Object(d.a)(t,2),i=n[0],c=n[1],o=Object(a.useRef)(null),r=V();Object(a.useEffect)((function(){!function(){var e;null===(e=o.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})}()}),[i]);return i.isLoading?Object(g.jsx)(M,{}):Object(g.jsxs)(C.a,{children:[i.me.name,Object(g.jsxs)(N.a,{container:!0,className:r.messagesRoot,alignItems:"center",children:[Object(g.jsx)("div",{className:r.messages,children:i.messages.length&&i.messages.map((function(e){var t=i.nameValue===e.name;return Object(g.jsx)(F,{ref:o,isMe:t,message:e})}))}),Object(g.jsx)("div",{ref:o}),Object(g.jsxs)(N.a,{className:r.newMessageRoot,container:!0,direction:"column",alignItems:"flex-end",children:[Object(g.jsx)(w.a,{variant:"filled",onChange:function(e){return i.setMessageValue(e.currentTarget.value)},value:i.messageValue,fullWidth:!0}),Object(g.jsx)(G,{}),Object(g.jsx)(y.a,{className:r.sendButton,onClick:function(){var e,t={event:"message",id:Date.now().toString(),name:i.me.name,body:i.messageValue};null===c||void 0===c||c.send(JSON.stringify(t)),i.setMessageValue(""),null===(e=o.current)||void 0===e||e.scrollTo(0,o.current.scrollHeight)},variant:"outlined",children:"send"})]})]})]})})),U=(n(173),"/CHAT_ROUTE"),K=[{path:U,Component:W}],q=function(){return Object(g.jsxs)(x.d,{children:[K.map((function(e){var t=e.path,n=e.Component;return Object(g.jsx)(x.b,{path:t,component:n,exact:!0},t)})),Object(g.jsx)(x.a,{to:U})]})},z=(n(116),n(68)),Q=Object(L.a)((function(){var e,t=Object(a.useState)((function(){return new R})),n=Object(d.a)(t,1)[0],i=Object(a.useState)(null),c=Object(d.a)(i,2),o=c[0],r=c[1],u=a.useMemo((function(){return[n,o]}),[n,o]),f=function(){var e=Object(j.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.setMe({id:Date.now().toString(),name:n.nameValue}),n.setLoading(!0),e.t0=r,e.next=5,new WebSocket("wss://ws-simple-chat-api.herokuapp.com");case 5:e.t1=e.sent,(0,e.t0)(e.t1);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();if(o&&(o.onmessage=function(e){n.setMessages(JSON.parse(e.data))},o.onopen=function(){n.setConnected(!0);var e={event:h.CONNECTION,id:n.me.id,name:n.nameValue,body:""};null===o||void 0===o||o.send(JSON.stringify(e)),n.setLoading(!1)},o.onmessage=function(e){var t=JSON.parse(e.data);n.setMessages(t)},o.onclose=function(){n.setConnected(!1);var e={event:h.CONNECTION,id:n.me.id,name:n.nameValue,body:""};o.send(JSON.stringify(e))},o.onerror=function(){n.setConnected(!1),setTimeout((function(){return f()}),1e3)}),n.isLoading)return Object(g.jsx)(M,{});var m=(null===(e=n.nameValue)||void 0===e?void 0:e.trim().length)<3;return Object(g.jsx)(z.a,{children:Object(g.jsxs)(s.Provider,{value:u,children:[Object(g.jsx)(v,{}),n.isConnected?Object(g.jsx)(q,{}):Object(g.jsx)(g.Fragment,{children:Object(g.jsxs)(N.a,{container:!0,justifyContent:"center",alignItems:"stretch",children:[Object(g.jsx)(w.a,{variant:"filled",onChange:function(e){return n.setNameValue(e.currentTarget.value)},value:n.nameValue}),Object(g.jsx)(y.a,{disabled:m,color:"info",onClick:f,variant:"contained",children:"connect"})]})})]})})})),Y=Q;o.a.render(Object(g.jsx)(i.a.StrictMode,{children:Object(g.jsx)(Y,{})}),document.getElementById("root")),r()}},[[117,1,2]]]);
//# sourceMappingURL=main.68e9546a.chunk.js.map