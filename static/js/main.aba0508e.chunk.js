(this["webpackJsonpreact-ws-chat"]=this["webpackJsonpreact-ws-chat"]||[]).push([[0],{139:function(e,t,n){},150:function(e,t,n){},169:function(e,t,n){"use strict";n.r(t);var a,r=n(0),c=n.n(r),i=n(37),s=n.n(i),o=(n(139),function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,243)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,c=t.getLCP,i=t.getTTFB;n(e),a(e),r(e),c(e),i(e)}))}),l=n(14),u=n.n(l),d=n(18),j=n(11),h=n(241),b=n(228),f=n(232),p=n(35),O=n(220),m={fontFamily:"monospace",fontSize:"2rem"},v=Object(O.a)({title:{display:"grid",gridAutoRows:"auto",justifyItems:"center",minHeight:90,alignItems:"center","&>div:first-child":Object(p.a)(Object(p.a)({},m),{},{textTransform:"uppercase"})},onlineCounter:{color:"grey"}});a=r.createContext(undefined);var g,x=n(34),y=Object(O.a)({timeRoot:{fontSize:"2rem",fontFamily:"monospace",color:"gray",whiteSpace:"nowrap"}}),w=function(e){var t=function(e){var t=e.toString();return t.length>1?t:"0".concat(t)},n=t(e.getHours()),a=t(e.getMinutes()),r=t(e.getSeconds());return"".concat(n,": ").concat(a,": ").concat(r)},C=function(e){var t=new Date(e/1e3),n=t.getFullYear(),a=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][t.getMonth()];return t.getDate()+" "+a+" "+n+" "+t.getHours()+":"+t.getMinutes()+":"+t.getSeconds()},k=n(1),N=function(e){e.children;var t=e.clocRef,n=Object(r.useState)(new Date),a=Object(j.a)(n,2),c=a[0],i=a[1],s=y();return Object(r.useEffect)((function(){var e=setTimeout((function(){return i(new Date)}),1e3);return function(){return clearTimeout(e)}}),[c]),Object(k.jsx)("div",{ref:t,className:s.timeRoot,children:w(c)})},R=n(19),T=n(44),S=n(230),E=n(225),I=n(231),M=function(e){return Object(k.jsx)(S.a,{children:Object(k.jsx)(b.a,{container:!0,alignItems:"center",justifyContent:"center",style:{height:window.innerHeight-30},children:Object(k.jsx)(I.a,{color:"primary"})})})},U=Object(O.a)({messagesRoot:{maxHeight:window.innerHeight-30},messages:{width:"100%",height:"70vh",backgroundColor:"#354765",overflowY:"auto"},newMessageRoot:{position:"relative",width:"100%",rowGap:20,color:"#ffffff"},textField:{width:"80%"},btn:{"&.MuiButton-contained":{backgroundColor:"#3a64a8",border:"none",color:"#ffffff",width:"20%",height:56,"&:hover":{backgroundColor:"#7094d2",color:"#354765"}}}}),W=n(118),_=n.n(W),A=n(4),F=Object(O.a)(Object(A.a)({mainBlock:{minWidth:"40vw",margin:10,borderRadius:"4%",maxWidth:"60%",width:"fit-content",padding:15,display:"grid",justifyContent:"flexStart",rowGap:20,fontFamily:"serif",position:"relative"},info:{color:"#afbed2",margin:"20px 30px"},name:{display:"block",maxWidth:"max-content"},copy:{cursor:"pointer",position:"absolute",opacity:.7,top:8},date:{fontSize:"0.7em"}},"@media (max-width:".concat(520,"px)"),{mainBlock:{minWidth:"70vw",fontSize:"1.4em"}})),L=n(15),G=n(29),J=n(30),V=n(16);!function(e){e.MESSAGE="message",e.QUIT="quit",e.CONNECTION="connection"}(g||(g={}));var B,D=function(){function e(){Object(G.a)(this,e),this.messages=[],this.messageValue="",this.isLoading=!1,this.isConnected=!1,this.connectionCounter=0,Object(V.d)(this,{},{deep:!0})}return Object(J.a)(e,[{key:"setConnected",value:function(e){this.isConnected=e}},{key:"setLoading",value:function(e){this.isLoading=e}},{key:"setMessageValue",value:function(e){this.messageValue=e}},{key:"setMessages",value:function(e){this.messages=[].concat(Object(L.a)(this.messages),Object(L.a)(e))}},{key:"setConnectionCounter",value:function(e){this.connectionCounter=e}}]),e}(),z=Object(x.a)((function(e){var t,n=e.isMe,c=e.message,i=Object(r.useContext)(a),s=Object(j.a)(i,3),o=s[0],l=(s[1],s[2],F());c.event===g.CONNECTION&&o.setConnectionCounter(c.connectionCounter);var u={backgroundColor:n?"#3a64a8":"#536f9b",color:n?"#f6dbaa":"#eee4cc",marginLeft:n?"auto":"10%",marginRight:n?"10%":0,paddingRight:10};return Object(k.jsx)(b.a,{direction:"column",container:!0,children:c.event===g.MESSAGE?Object(k.jsxs)("div",{className:l.mainBlock,style:u,children:[Object(k.jsx)("h3",{className:l.name,style:{justifySelf:"".concat(!n&&"flex-end"),borderBottom:"2px solid ".concat(n?"#f6dbaa":"#eee4cc")},children:null===(t=c.name)||void 0===t?void 0:t.toUpperCase()}),Object(k.jsx)("span",{children:c.body}),Object(k.jsx)("span",{className:l.date,children:C(1e3*c.date)}),Object(k.jsx)("div",{onClick:function(){return navigator.clipboard.writeText(c.body)},style:n?{right:2}:{left:6},title:"\u0441\u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435",className:l.copy,children:Object(k.jsx)(_.a,{})})]}):c.event===g.CONNECTION?Object(k.jsxs)("span",{className:l.info,children:[c.name," \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u043b\u0441\u044f \u043a \u0447\u0430\u0442\u0443.. ."]}):Object(k.jsxs)("span",{className:l.info,children:[c.name," \u0432\u044b\u0448\u0435\u043b \u0438\u0437 \u0447\u0430\u0442\u0430.. ."]})})})),H=n(119),P=n.n(H),q=n(99),K=n.n(q),Y=n(120),Q=n.n(Y),X=Object(O.a)({emojiRoot:{position:"absolute",zIndex:1,top:10},picker:{top:-350}}),Z=Object(x.a)((function(e){e.children;var t=e.frameWidth,n=void 0===t?0:t,c=Object(r.useContext)(a),i=Object(j.a)(c,3),s=i[0],o=(i[1],i[2],X()),l=Object(r.useState)(!1),u=Object(j.a)(l,2),d=u[0],h=u[1];return Object(k.jsx)("div",{style:{right:"".concat(.2*n,"px")},className:P()(o.emojiRoot,Object(A.a)({},o.picker,d)),onBlur:function(){return h(!1)},children:d?Object(k.jsx)(K.a,{native:!0,groupNames:{smileys_people:"PEOPLE"},disableAutoFocus:!0,onEmojiClick:function(e,t){s.setMessageValue(t.emoji)},skinTone:q.SKIN_TONE_MEDIUM_DARK}):Object(k.jsx)(f.a,{onClick:function(){return h(!0)},children:Object(k.jsx)(Q.a,{})})})})),$=n(83),ee=Object(x.a)((function(e){var t,n=Object(r.useContext)(a),c=Object(j.a)(n,3),i=c[0],s=c[1],o=c[2],l=Object(r.useRef)(null),u=U(),d=Object($.a)({initialValues:{message:"\u0432\u0432\u0435\u0434\u0438\u0442\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435"},onSubmit:function(e){return function(){if(i.messageValue.trim()){var e={event:"message",id:Date.now().toString(),name:s.me.email,body:i.messageValue};null===o||void 0===o||o.send(JSON.stringify(e)),i.setMessageValue("")}}()}}),h=i.messages.length;return Object(r.useEffect)((function(){!function(){var e;null===(e=l.current)||void 0===e||e.scrollTo(0,l.current.scrollHeight)}()})),i.isLoading?Object(k.jsx)(M,{}):Object(k.jsx)(S.a,{children:Object(k.jsxs)("form",{onSubmit:d.handleSubmit,children:[Object(k.jsx)(b.a,{container:!0,className:u.messagesRoot,alignItems:"center",children:Object(k.jsx)(b.a,{ref:l,className:u.messages,children:h&&i.messages.map((function(e){var t=s.me.email===e.name;return Object(k.jsx)(z,{isMe:t,message:e},e.id)}))})}),Object(k.jsxs)(b.a,{className:u.newMessageRoot,container:!0,direction:"row",alignItems:"flex-end",children:[Object(k.jsx)(E.a,{id:"message",name:"message",label:"message",variant:"filled",autoComplete:"off",onChange:function(e){return i.setMessageValue(e.currentTarget.value)},value:i.messageValue,className:u.textField}),Object(k.jsx)(Z,{frameWidth:null===(t=l.current)||void 0===t?void 0:t.clientWidth}),Object(k.jsx)(f.a,{type:"submit",variant:"contained",className:u.btn,children:Object(k.jsx)("strong",{children:"send"})})]})]})})})),te=n(237),ne=n(219),ae=n(222),re=n(235),ce=n(226),ie=n(221),se=n(224),oe=Object(O.a)({root:{marginTop:"5%",position:"relative"},selectWrapper:{maxWidth:100,alignContent:"center"},alert:{position:"absolute",width:300,right:"25%",opacity:.7,zIndex:0,top:"5%"},fieldWrapper:{position:"relative"},validatorMessage:{position:"absolute",top:0,right:"-124px",width:120}});!function(e){e.EN="EN",e.RU="RU"}(B||(B={}));var le,ue=Object.create(B),de={10:ue.RU,20:ue.EN},je={RU:de[10],EN:de[20]},he=function(e){var t=e.onSubmit,n=(e.children,e.title),c=e.withOptions,i=void 0!==c&&c,s=e.submitButtonText,o=e.showAlert,l=void 0!==o&&o,u=e.onCloseAlert,d=Object(r.useContext)(a),h=Object(j.a)(d,3),O=(h[0],h[1],h[2],oe()),m=Object($.a)({initialValues:{name:"",email:"",password:"",country:"",city:"",language:je.RU},validate:function(e){return function(e,t){var n=e.name,a=e.password,r=(e.city,e.country,e.language,e.email,{});return t&&n.length<=3&&(r.name="Required more 3 symbols"),a.length<=3&&(r.password="Required more 3 symbols"),r}(e,i)},onSubmit:function(e){var n=e.name,a=e.password,r=e.city,c=e.country,i=e.language,s=e.email;try{t&&t({name:n,password:a,city:r,country:c,language:i,email:s})}catch(o){console.log(o)}}});return Object(k.jsxs)("form",{className:O.root,onSubmit:m.handleSubmit,children:[Object(k.jsxs)(te.a,{className:O.alert,children:[Object(k.jsx)(ne.a,{in:l,children:Object(k.jsx)(ae.a,{onClose:u,severity:"info",children:i?"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0438\u043c\u044f \u043a\u043e\u0442\u043e\u0440\u043e\u0435 \u0431\u0443\u0434\u0435\u0442 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u043e \u0434\u043b\u044f \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438 \u0438 \u043e\u0442\u043f\u0440\u0430\u0432\u043a\u0438 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0439 \u0432 \u0447\u0430\u0442\u0435":"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0438\u043c\u044f \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u0435 \u0432 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0435 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438"})}),Object(k.jsx)(ne.a,Object(p.a)(Object(p.a)({in:l,style:{transformOrigin:"0 0 0"}},l?{timeout:1e3}:{}),{},{children:Object(k.jsx)(ae.a,{severity:"info",children:i?"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043f\u0430\u0440\u043e\u043b\u044c \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0431\u0443\u0434\u0435\u0442 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d \u0434\u043b\u044f \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438":"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043f\u0430\u0440\u043e\u043b\u044c \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u0439 \u0432 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0435 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438"})}))]}),Object(k.jsxs)(b.a,{container:!0,justifyContent:"center",alignItems:"center",direction:"column",gap:2,children:[n,i&&Object(k.jsxs)(re.a,{fullWidth:!0,classes:{root:O.selectWrapper},children:[Object(k.jsx)(ce.a,{id:"select-label",children:"\u042f\u0437\u044b\u043a"}),Object(k.jsxs)(ie.a,{labelId:"select-label",id:"lang",label:"lang",name:"lang",onChange:m.handleChange,defaultValue:je.RU,children:[Object(k.jsx)(se.a,{value:je.RU,children:B.RU}),Object(k.jsx)(se.a,{value:je.EN,children:B.EN})]})]}),Object(k.jsxs)("div",{className:O.fieldWrapper,children:[Object(k.jsx)(E.a,{autoFocus:!0,variant:"filled",onChange:m.handleChange,value:m.values.email,required:!0,id:"email",name:"email",label:"email"}),Object(k.jsx)(te.a,{className:O.validatorMessage,children:Object(k.jsx)(ne.a,{in:!!m.errors.email,children:Object(k.jsx)(ae.a,{severity:"error",children:m.errors.email})})})]}),i&&Object(k.jsxs)("div",{className:O.fieldWrapper,children:[Object(k.jsx)(E.a,{variant:"filled",onChange:m.handleChange,value:m.values.name,required:!0,id:"name",name:"name",label:"name"}),Object(k.jsx)(te.a,{className:O.validatorMessage,children:Object(k.jsx)(ne.a,{in:!!m.errors.name,children:Object(k.jsx)(ae.a,{severity:"error",children:m.errors.name})})})]}),Object(k.jsxs)("div",{className:O.fieldWrapper,children:[Object(k.jsx)(E.a,{inputProps:{autoComplete:"new-password",form:{autoComplete:"off"}},variant:"filled",onChange:m.handleChange,value:m.values.password,type:"password",id:"password",name:"password",label:"password"}),Object(k.jsx)(te.a,{className:O.validatorMessage,children:Object(k.jsx)(ne.a,{in:!!m.errors.password,children:Object(k.jsx)(ae.a,{severity:"error",children:m.errors.password})})})]}),i&&Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)(E.a,{variant:"filled",onChange:m.handleChange,value:m.values.country,id:"country",name:"country",label:"country"}),Object(k.jsx)(E.a,{variant:"filled",onChange:m.handleChange,value:m.values.city,id:"city",name:"city",label:"city"})]}),Object(k.jsx)(f.a,{type:"submit",disabled:!m.isValid||!m.dirty,color:"info",variant:"contained",children:s})]})]})},be=Object(O.a)({title:Object(p.a)(Object(p.a)({},m),{},{textTransform:"uppercase"})}),fe=n(123),pe=n.n(fe),Oe=Object(O.a)({children:{display:"grid",gridTemplateColumns:"1fr 24px",columnGap:6,cursor:"pointer"},title:Object(p.a)(Object(p.a)({},m),{},{textTransform:"uppercase"})}),me=Object(O.a)({root:{marginTop:"4%"},btn:{height:100,width:300}});!function(e){e.LOGIN_ROUTE="/login",e.CHAT_ROUTE="/chat",e.REGISTRATION_ROUTE="/registration",e.JOIN_ROUTE="/join",e.PROFILE_ROUTE="/profile"}(le||(le={}));var ve=[{path:le.JOIN_ROUTE,Component:function(){var e=me();return Object(k.jsxs)(b.a,{className:e.root,container:!0,justifyContent:"center",direction:"column",alignItems:"center",gap:10,children:[Object(k.jsx)(b.a,{item:!0,children:Object(k.jsx)(T.b,{to:le.REGISTRATION_ROUTE,children:Object(k.jsx)(f.a,{size:"large",variant:"contained",classes:{root:e.btn},children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"})})}),Object(k.jsx)(b.a,{item:!0,children:Object(k.jsx)(T.b,{to:le.LOGIN_ROUTE,children:Object(k.jsx)(f.a,{size:"large",variant:"contained",classes:{root:e.btn},children:"\u0412\u0445\u043e\u0434"})})})]})}},{path:le.LOGIN_ROUTE,Component:function(){var e=be(),t=Object(r.useContext)(a),n=Object(j.a)(t,3),c=(n[0],n[1]);n[2];return Object(k.jsx)(he,{onSubmit:function(e){var t=e.password,n=e.email;c.login(n,t)},submitButtonText:"\u0412\u043e\u0439\u0442\u0438",title:Object(k.jsx)("div",{className:e.title,children:" \u0412\u0445\u043e\u0434 "})})}},{path:le.REGISTRATION_ROUTE,Component:function(){var e,t=Oe(),n=Object(r.useState)(!1),c=Object(j.a)(n,2),i=c[0],s=c[1],o=Object(r.useContext)(a),l=Object(j.a)(o,3),h=(l[0],l[1]),b=(l[2],function(){var e=Object(d.a)(u.a.mark((function e(t){var n,a,r,c,i,s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.country,a=t.language,r=t.city,c=t.password,i=t.name,s=t.email,e.next=3,h.registration({name:i,email:s,password:c,city:r,country:n,language:a});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),f=Object(r.useCallback)((function(){s(!0),e=setTimeout((function(){s(!1)}),5e3)}),[]),p=Object(r.useCallback)((function(){s(!1),clearTimeout(e)}),[]);return Object(k.jsx)(he,{onCloseAlert:p,showAlert:i,onSubmit:b,submitButtonText:"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f",withOptions:!0,title:Object(k.jsxs)("div",{className:t.children,onClick:i?p:f,children:[Object(k.jsx)("div",{className:t.title,children:" \u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"}),Object(k.jsx)(pe.a,{})]})})}}],ge=(le.CHAT_ROUTE,le.PROFILE_ROUTE,n(238)),xe=n(239),ye=n(240),we=Object(O.a)({root:{margin:"10px 0",maxWidth:"15vw"},description:{fontSize:"0.8em",color:"grey","&>div>strong":{fontSize:"1.1em"}},iconWrapper:{position:"relative"},icon:{position:"absolute",width:60,height:60,top:-24,right:-24}}),Ce=Object(x.a)((function(e){e.children;var t,n,c,i,s,o,l,u=Object(r.useContext)(a),d=Object(j.a)(u,4),h=(d[0],d[1],d[2],d[3]),f=we();return Object(r.useEffect)((function(){h.fetchWeather()}),[]),console.log(Object(V.h)(h.weather)),Object(k.jsx)(b.a,{container:!0,direction:"column",classes:{root:f.root},children:Object(k.jsxs)(ge.a,{children:[Object(k.jsxs)(xe.a,{children:[Object(k.jsx)(ye.a,{padding:"checkbox",align:"left",children:Object(k.jsx)("span",{children:null===h||void 0===h||null===(t=h.weather)||void 0===t?void 0:t.name})}),Object(k.jsx)(ye.a,{classes:{root:f.iconWrapper},padding:"checkbox",align:"right",children:Object(k.jsx)("img",{className:f.icon,src:null===h||void 0===h||null===(n=h.weather)||void 0===n||null===(c=n.weather)||void 0===c?void 0:c.icon})})]}),Object(k.jsxs)(xe.a,{children:[Object(k.jsx)(ye.a,{padding:"checkbox",align:"left",children:Object(k.jsx)("span",{children:"\u0442\u0435\u043c\u043f\u0435\u0440\u0430\u0442\u0443\u0440\u0430 \u0432\u043e\u0437\u0434\u0443\u0445\u0430 "})}),Object(k.jsx)(ye.a,{padding:"checkbox",align:"right",children:Object(k.jsx)("strong",{children:Math.ceil((null===h||void 0===h||null===(i=h.weather)||void 0===i||null===(s=i.main)||void 0===s?void 0:s.temp)-273.15)})})]}),Object(k.jsxs)(xe.a,{children:[Object(k.jsx)(ye.a,{padding:"checkbox",align:"left",children:Object(k.jsx)("span",{children:" \u043e\u0449\u0443\u0449\u0430\u0435\u0442\u0441\u044f \u043a\u0430\u043a "})}),Object(k.jsx)(ye.a,{padding:"checkbox",align:"right",children:Object(k.jsx)("strong",{children:Math.ceil((null===h||void 0===h||null===(o=h.weather)||void 0===o||null===(l=o.main)||void 0===l?void 0:l.feels_like)-273.15)})})]})]})})})),ke=Object(x.a)((function(e){var t,n=Object(r.useContext)(a),c=Object(j.a)(n,3),i=c[0],s=c[1],o=(c[2],i.connectionCounter),l=v(),u=Object(r.useRef)(null),d=!!s.me.email,p=Object(R.g)().pathname.includes(le.LOGIN_ROUTE),O=Object(R.g)().pathname.includes(le.JOIN_ROUTE),m=(null===u||void 0===u||null===(t=u.current)||void 0===t?void 0:t.offsetWidth)||0,g=Object(r.useCallback)((function(){return s.logout()}),[]);return Object(k.jsx)(h.a,{color:"transparent",variant:"outlined",elevation:0,position:"static",children:Object(k.jsxs)(b.a,{container:!0,item:!0,alignItems:"center",justifyContent:"space-evenly",children:[Object(k.jsx)("div",{style:{minWidth:m||"11vw"},children:d&&Object(k.jsx)(Ce,{})}),Object(k.jsxs)("div",{className:l.title,children:[Object(k.jsx)("div",{children:"\u0427\u0430\u0442 \u0438\u043c\u0435\u043d\u0438 \u0410\u043b\u044c\u0444\u0440\u0435\u0434\u043e \u0413\u0430\u0440\u0441\u0438\u0438"}),d?Object(k.jsxs)("span",{className:l.onlineCounter,children:["\u0441\u0435\u0439\u0447\u0430\u0441 \u043e\u043d\u043b\u0430\u0439\u043d: ",o||0," \u0447\u0435\u043b\u043e\u0432\u0435\u043a"]}):!O&&(p?Object(k.jsx)(b.a,{item:!0,children:Object(k.jsx)(T.b,{to:le.REGISTRATION_ROUTE,children:Object(k.jsx)(f.a,{variant:"text",children:"\u043a \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438"})})}):Object(k.jsx)(b.a,{item:!0,children:Object(k.jsx)(T.b,{to:le.LOGIN_ROUTE,children:Object(k.jsx)(f.a,{variant:"text",children:"\u043a \u043b\u043e\u0433\u0438\u043d\u0443"})})}))]}),Object(k.jsx)(N,{clocRef:u}),d&&Object(k.jsx)(f.a,{onClick:g,variant:"outlined",children:"Logout"})]})})})),Ne=(n(150),n(68)),Re=n.n(Ne),Te="https://ws-simple-chat-api.herokuapp.com/",Se=Re.a.create({baseURL:Te});Se.interceptors.request.use((function(e){if(e&&e.headers)return e.headers.Authorization="Bearer ".concat(localStorage.getItem("token")),e})),Se.interceptors.response.use((function(e){return e}),function(){var e=Object(d.a)(u.a.mark((function e(t){var n,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.config,401!==t.response.status||!t.config||t.config._isRetry){e.next=14;break}return n._isRetry=!0,e.prev=3,e.next=6,Re.a.post("".concat(Te,"/auth/refresh"),{withCredentials:!0});case 6:return a=e.sent,localStorage.setItem("token",a.data.accessToken),e.abrupt("return",Se.request(n));case 11:e.prev=11,e.t0=e.catch(3),console.log("\u041d\u0415 \u0410\u0412\u0422\u041e\u0420\u0418\u0417\u041e\u0412\u0410\u041d");case 14:throw t;case 15:case"end":return e.stop()}}),e,null,[[3,11]])})));return function(t){return e.apply(this,arguments)}}());var Ee=Se,Ie=function(){function e(){Object(G.a)(this,e)}return Object(J.a)(e,null,[{key:"login",value:function(){var e=Object(d.a)(u.a.mark((function e(t,n){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Ee.post("auth/login",{email:t,password:n}));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"registration",value:function(){var e=Object(d.a)(u.a.mark((function e(t){var n,a,r,c,i,s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.password,a=t.name,r=t.country,c=t.language,i=t.city,s=t.email,e.abrupt("return",Ee.post("auth/registration",{email:s,password:n,name:a,country:r,language:c,city:i}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"logout",value:function(){var e=Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Ee.delete("auth/logout"));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"refresh",value:function(){var e=Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Ee.post("auth/refresh"));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),e}(),Me=function(){function e(){Object(G.a)(this,e),this.me={},Object(V.d)(this,{},{deep:!0})}return Object(J.a)(e,[{key:"setMe",value:function(e){this.me=e||{}}},{key:"setAuthData",value:function(e){localStorage.setItem("token",e.data.accessToken),this.setMe(e.data.user)}},{key:"login",value:function(){var e=Object(d.a)(u.a.mark((function e(t,n){var a,r,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Ie.login(t,n);case 3:a=e.sent,this.setAuthData(a),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.warn(null===(r=e.t0.response)||void 0===r||null===(c=r.data)||void 0===c?void 0:c.message);case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"registration",value:function(){var e=Object(d.a)(u.a.mark((function e(t){var n,a,r,c,i,s,o,l,d;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.password,a=t.name,r=t.country,c=t.language,i=t.city,s=t.email,e.prev=1,e.next=4,Ie.registration({password:n,email:s,name:a,country:r,language:c,city:i});case 4:o=e.sent,this.setAuthData(o),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.warn(null===(l=e.t0.response)||void 0===l||null===(d=l.data)||void 0===d?void 0:d.message);case 11:case"end":return e.stop()}}),e,this,[[1,8]])})));return function(t){return e.apply(this,arguments)}}()},{key:"refresh",value:function(){var e=Object(d.a)(u.a.mark((function e(){var t,n,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Ie.refresh();case 3:t=e.sent,localStorage.setItem("token",t.data.accessToken),this.setMe(t.data.user),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.warn(null===(n=e.t0.response)||void 0===n||null===(a=n.data)||void 0===a?void 0:a.message);case 11:case"end":return e.stop()}}),e,this,[[0,8]])})));return function(){return e.apply(this,arguments)}}()},{key:"logout",value:function(){var e=Object(d.a)(u.a.mark((function e(){var t,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Ie.logout();case 3:e.sent,this.setMe(null),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.warn(null===(t=e.t0.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.message);case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));return function(){return e.apply(this,arguments)}}()}]),e}(),Ue=Me,We=function(){return Object(k.jsxs)(R.d,{children:[ve.map((function(e){var t=e.path,n=e.Component;return Object(k.jsx)(R.b,{path:t,component:n,exact:!0},t)})),Object(k.jsx)(R.a,{to:le.JOIN_ROUTE})]})},_e=Re.a.create({baseURL:"http://api.fungenerators.com/fact/"}),Ae=function(){function e(){Object(G.a)(this,e)}return Object(J.a)(e,null,[{key:"fetchFact",value:function(){var e=Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",_e.get("random"));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),e}(),Fe=function(){function e(){Object(G.a)(this,e)}return Object(J.a)(e,null,[{key:"fetchWeather",value:function(){var e=Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Ee.get("/utils/weather",{}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),e}(),Le=function(){function e(){Object(G.a)(this,e),this.fact="",this.weather={},Object(V.d)(this,{},{deep:!0})}return Object(J.a)(e,[{key:"setFact",value:function(e){this.fact=e||""}},{key:"setWeather",value:function(e){this.weather=e||{}}},{key:"fetchFact",value:function(){var e=Object(d.a)(u.a.mark((function e(){var t,n,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Ae.fetchFact();case 3:t=e.sent,this.setFact(t.data.contents.fact),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.warn(null===(n=e.t0.response)||void 0===n||null===(a=n.data)||void 0===a?void 0:a.message);case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));return function(){return e.apply(this,arguments)}}()},{key:"fetchWeather",value:function(){var e=Object(d.a)(u.a.mark((function e(){var t,n,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Fe.fetchWeather();case 3:t=e.sent,this.setWeather(t.data),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.warn(null===(n=e.t0.response)||void 0===n||null===(a=n.data)||void 0===a?void 0:a.message);case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));return function(){return e.apply(this,arguments)}}()}]),e}(),Ge=Le,Je=Object(x.a)((function(e){var t=Object(r.useState)((function(){return new D})),n=Object(j.a)(t,1)[0],c=Object(r.useState)((function(){return new Ue})),i=Object(j.a)(c,1)[0],s=Object(r.useState)((function(){return new Ge})),o=Object(j.a)(s,1)[0],l=Object(r.useState)(null),h=Object(j.a)(l,2),b=h[0],f=h[1],p=r.useMemo((function(){return[n,i,b,o]}),[n,i,b,o]),O=!!i.me.email;console.log(Object(V.h)(i));var m=function(){var e=Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.setLoading(!0),e.t0=f,e.next=4,new WebSocket("wss://ws-simple-chat-api.herokuapp.com");case 4:e.t1=e.sent,(0,e.t0)(e.t1);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(r.useEffect)((function(){localStorage.getItem("token")&&i.refresh()}),[]),Object(r.useEffect)((function(){!b&&O&&m()}),[O]),b&&(b.onmessage=function(e){n.setMessages(JSON.parse(e.data))},b.onopen=function(){n.setConnected(!0);var e={event:g.CONNECTION,id:i.me.id,name:i.me.email,body:i.me.email};null===b||void 0===b||b.send(JSON.stringify(e)),n.setLoading(!1)},b.onmessage=function(e){var t=JSON.parse(e.data);n.setMessages(t)},b.onclose=function(){n.setConnected(!1);var e={event:g.CONNECTION,id:i.me.id,name:i.me.email,body:""};b.send(JSON.stringify(e))},b.onerror=function(){n.setConnected(!1),setTimeout((function(){return m()}),1e3)}),n.isLoading?Object(k.jsx)(M,{}):Object(k.jsx)(T.a,{children:Object(k.jsxs)(a.Provider,{value:p,children:[Object(k.jsx)(ke,{}),O?Object(k.jsx)(ee,{}):Object(k.jsx)(We,{})]})})})),Ve=Je;s.a.render(Object(k.jsx)(c.a.StrictMode,{children:Object(k.jsx)(Ve,{})}),document.getElementById("root")),o()}},[[169,1,2]]]);
//# sourceMappingURL=main.aba0508e.chunk.js.map